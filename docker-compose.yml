version: "3"
services:
  oxo:
    image: ghcr.io/giftzwerg02/oxo:latest
    init: true
    environment:
      - DISCORD_TOKEN_FILE=/run/secrets/discord_token
    secrets:
      - discord_token
    labels:
      com.centurylinklabs.watchtower.enable: "true"
  shepherd:
    image: mazzolino/shepherd
    environment:
      - SLEEP_TIME=10s
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    deploy:
      placement:
        constraints:
        - node.role == manager

secrets:
  discord_token:
    external: true